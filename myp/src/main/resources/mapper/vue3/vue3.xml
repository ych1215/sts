<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.vue3.dao.EmpMapper">

	
	<select  id="selectEmpSchDtl" parameterType="Map" resultType="Map">
		
		SELECT SEQ , NAME , RDO , OLD
		  , SELECTV ,
		  ENTERING_DATE ,
		  JOINING_TIME
		 FROM VUE_EMP_BORD_LIST
		WHERE SEQ = #{SEQ}
			 
		 
	</select>


	<select  id="selectUserList" parameterType="Map" resultType="Map">
		
		SELECT SEQ , NAME , RDO , OLD
		  , CASE WHEN SELECTV = 'A' THEN '대리'
		         WHEN SELECTV = 'B' THEN '과장'
		         WHEN SELECTV = 'C' THEN '부장'
		         WHEN SELECTV = 'D' THEN '대표이사'
		     ELSE NULL END AS SELECTV
		  
		 , ENTERING_DATE  || ' ' || JOINING_TIME AS ENTERING_DATE
		 , '수정' CRUD_TYPE  
		  , 'R' AS ROWTYPE
		 FROM VUE_EMP_BORD_LIST
		WHERE 1=1
		
		 <if test="empNm != null and empNm != ''  ">
			AND  NAME =  #{empNm}
		  </if>	 
		  ORDER BY SEQ DESC
			 
		 
	</select>
	
	
			<update id="insertEmp" parameterType="Map">
  MERGE INTO VUE_EMP_BORD_LIST A
        USING (
                 
                SELECT #{SEQ}     AS SEQ
				     , #{ROWTYPE} AS ROWTYPE
					 , #{NAME}    AS NAME
					 , #{RDO}     AS RDO
					 , #{SELECTV} AS SELECTV
					 , #{OLD}          AS OLD
					 , #{ENTERING_DATE} AS ENTERING_DATE
					 , #{JOINING_TIME}	AS JOINING_TIME			       
                  FROM dual               
            
              ) B
           ON ( A.SEQ = B.SEQ)
           WHEN MATCHED THEN
           
         UPDATE SET A.NAME          = B.NAME 
                  , A.RDO           = B.RDO
                  , A.SELECTV       = B.SELECTV
                  , A.OLD           = B.OLD
                  , A.ENTERING_DATE = B.ENTERING_DATE
                  , A.JOINING_TIME  = B.JOINING_TIME
             
           WHEN NOT MATCHED THEN
           
         INSERT ( 
                     A.SEQ , A.ROWTYPE , A.NAME , A.RDO ,  A.SELECTV , A.OLD , A.ENTERING_DATE , A.JOINING_TIME
                )
           VALUES
                ( 
				   (SELECT NVL(MAX(SEQ) + 1 , 1) FROM VUE_EMP_BORD_LIST ) , B.ROWTYPE , B.NAME , B.RDO ,  B.SELECTV , B.OLD , B.ENTERING_DATE , B.JOINING_TIME
              )   

	</update>
	


</mapper>

